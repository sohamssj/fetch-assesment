1.
SELECT BRAND_CODE, SUM(TOTAL_FINAL_PRICE) AS TOTAL_SPENT
FROM receipt_items
WHERE MONTH(PURCHASE_DATE) = 6
GROUP BY BRAND_CODE
ORDER BY TOTAL_SPENT DESC
LIMIT 1;

2. 
SELECT users.ID, SUM(receipt_items.TOTAL_FINAL_PRICE) AS total_spent
FROM users
JOIN receipts ON users.ID = receipts.USER_ID
JOIN receipt_items ON receipts.ID = receipt_items.REWARDS_RECEIPT_ID
WHERE MONTH(receipts.PURCHASE_DATE) = 8
GROUP BY users.ID
ORDER BY total_spent DESC
LIMIT 1;

3. 
SELECT users.ID, receipt_items.TOTAL_FINAL_PRICE AS price
FROM users
JOIN receipts ON users.ID = receipts.USER_ID
JOIN receipt_items ON receipts.ID = receipt_items.REWARDS_RECEIPT_ID
ORDER BY price DESC
LIMIT 1;

4. 
SELECT DESCRIPTION, MAX(TOTAL_FINAL_PRICE) AS MAX_PRICE
FROM receipt_items
GROUP BY DESCRIPTION
ORDER BY MAX_PRICE DESC
LIMIT 1;

5. 
SELECT COUNT(DISTINCT USER_ID) AS COUNT, DATE_TRUNC('month', DATE_SCANNED) AS MONTH
FROM receipts
GROUP BY MONTH
ORDER BY MONTH;
